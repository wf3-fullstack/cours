## COURS PHP 06


## COOKIES ET SESSIONS


## COOKIES

LE NAVIGATEUR PEUT ENVOYER DES INFORMATIONS AU SERVEUR
=> FORMULAIRES

DANS LES FORMULAIRES, ON A UN CHAMP input type="hidden"
=> PAS VISIBLE POUR LE VISITEUR MAIS QUAND MEME ENVOYE VERS LE SERVEUR

LES COOKIES C'EST PIRE, PARCE QUE LE NAVIGATEUR PEUT ENVOYER DES INFOS
HORS DES FORMULAIRES
=> A CHAQUE REQUETE, LE NAVIGATEUR VA ENVOYER CES COOKIES AU SERVEUR

=> LE NOM DE COOKIE VIENT DE CES "PEPITES" D'INFOS PLANQUEES 
        DANS LA REQUETE DU NAVIGATEUR VERS LE SERVEUR

=> EN PRATIQUE: LE SERVEUR PEUT AVOIR AVEC LES COOKIES 
    UN MOYEN DE DIFFERENCIER LES NAVIGATEURS => LES VISITEURS

=> LES SESSIONS SONT BASEES SUR UN COOKIE QUI SERT A IDENTIFIER CHAQUE NAVIGATEUR

COTE NAVIGATEUR: AVEC JS ON PEUT CREER/MODIFIER/SUPPRIMER DES COOKIES
    UN COOKIE: C'EST UNE PAIRE  => CLE/VALEUR

https://www.w3schools.com/js/js_cookies.asp

LES COOKIES SONT PARTAGEES A TRAVERS TOUTES LES PAGES DU SITE
=> MOYEN D'ECHANGER DES INFORMATIONS DANS LE NAVIGATEUR ENTRE PLUSIEURS PAGE


## EXEMPLES PRATIQUES DE COOKIES


MEMORISER UNE PREFERENCE UTILISATEUR
=> CHOIX DE LANGUE
=> CHOIX DE THEME DE COULEUR OU DE TAILLE DE POLICE
=> MEMORISER UN PANIER D'ACHATS

=> INTERET DE LA NAVIGATION PRIVEE
=> TOUS LES COOKIES SONT DETRUITS QUAND ON FERME L'ONGLET

=> COMME LES COOKIES SONT DANS NOS NAVIGATEURS
=> ON A LA POSSIBILITE DE SUPPRIMER CES COOKIES
=> "EFFACER MES TRACES"


## LES COOKIES COTE SERVEUR

### LECTURE DES COOKIES DU NAVIGATEUR

LES COOKIES SONT ENVOYEES A CHAQUE REQUETE AU SERVEUR
=> EN PHP, ON A UN MOYEN DE RECUPERER CES INFOS DE COOKIES

ON PEUT RECUPERER LES COOKIES DANS UN TABLEAU ASSOCIATIF SUPERGLOBAL
$_COOKIE

### ECRITURE DES COOKIES

https://www.php.net/manual/fr/features.cookies.php

https://www.php.net/manual/fr/function.setcookie.php

AVEC LA FONCTION setcookie 
LE SERVEUR PEUT AUSSI CREER DES COOKIES

=> LE SERVEUR PEUT ATTRIBUER UN IDENTIFIANT UNIQUE A CHAQUE VISITEUR
    (UN VISITEUR = UN NAVIGATEUR)


## SESSIONS AVEC PHP

LES COOKIES SONT STOCKEES DANS LE NAVIGATEUR
=> LE SERVEUR NE PEUT PAS FAIRE CONFIANCE A CES INFORMATIONS (EXTERIEURES)

PHP PROPOSE DES INFOS DE SESSIONS QUI SERONT STOCKEES COTE SERVEUR

https://www.php.net/manual/fr/reserved.variables.session.php

ON PEUT AJOUTER DES CLES/VALEURS MAIS COTE SERVEUR
ET QUI SONT ASSOCIEES AU COOKIE PHPSESSID

=> LE SERVEUR PEUT DIFFERENCIER LES VISITEURS 
    ET STOCKER DES INFORMATIONS CONFIDENTIELLES COTE SERVEUR

## SUPPRESSION DE COOKIE

https://www.php.net/manual/fr/function.session-destroy.php


## DOSSIER DE SESSIONS

PHP CREE UN FICHIER PAR SESSION UTILISATEUR
ET STOCKE LES INFOS DE SESSION DANS CE FICHIER
=> PERMET DE STOCKER DES INFOS CONFIDENTIELLES QUI SERONT ACCESSIBLES SEULEMENT COTE SERVEUR

=> LA FAIBLESSE DE SECURITE RESIDE DANS LE COOKIE PHPSESSID
    QUI SERT D'IDENTIFIANT

=> VOL DE SESSION PEUT PERMETTRE D'USURPER LA SESSION D'UNE AUTRE PERSONNE


## EN PRATIQUE:

QUAND UN VISITEUR VA SE CONNECTER SUR LA PAGE DE LOGIN
=> ON VA STOCKER SON LOGIN ET SON EMAIL ET AUSSI SON NIVEAU D'ACCES
    DANS UNE SESSION => LE NAVIGATEUR NE PEUT CHANGER CES INFORMATIONS

ASTUCE: CRYPTER UN COOKIE AU LIEU DE LE STOCKER EN SESSION


SUR CHROME
COOKIE PHPSESSID=7utvsjqrsnsp0pk1idq08tp8hh
=> FICHIER SESSION SERVEUR php/model/session/sess_7utvsjqrsnsp0pk1idq08tp8hh
test1211
=> level=10

SUR FIREFOX
COOKIE PHPSESSID=vbfcq5p2jvvva5mch8in7acei9
=> FICHIER SESSION SERVEUR php/model/session/sess_vbfcq5p2jvvva5mch8in7acei9
modif1707
=> level=7






